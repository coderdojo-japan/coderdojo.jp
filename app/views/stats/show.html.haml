- provide(:title, 'çµ±è¨ˆæƒ…å ±')
- provide(:desc,  'CoderDojo ã®çµ±è¨ˆæƒ…å ±ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚')
- provide(:url,   @url)

%script{ type: 'text/javascript', src: '/js/jquery.japan-map.js'}

%section.cover{style: 'padding-top:40px; background-color: white;'}
  = image_tag "stats_cover.png"

%section#top.dojos.text-center
  %h1 çµ±è¨ˆæƒ…å ±
  %div{style: "margin-top: 30px;"}
    æœ¬ãƒšãƒ¼ã‚¸ã§ã¯ CoderDojo ã®çµ±è¨ˆæƒ…å ±ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚
    %br.ignore-sp<>
    CoderDojo ã®æ´»å‹•çŠ¶æ³ã‚’æŠŠæ¡ã™ã‚‹éš›ãªã©ã«ã”æ´»ç”¨ãã ã•ã„ã€‚

  %h3#graph{style: "margin-top: 60px;"} ğŸ“Š æ¨ç§»ã‚°ãƒ©ãƒ•
  %div{align: 'center'}
    = high_chart_globals(@high_charts_globals)
    %br
    = high_chart("annual_dojos",           @annual_dojos_chart)
    %br
    = high_chart("annual_event_histories", @annual_event_histories_chart)
    %br
    = high_chart("annual_participants",    @annual_participants_chart)

  %h3#data{style: "margin-top: 80px; margin-bottom: 30px;"} ğŸ†• æœ€æ–°ãƒ‡ãƒ¼ã‚¿
  2020å¹´ã®ãƒ‡ãƒ¼ã‚¿ã‚‚å«ã‚ãŸæœ€æ–°ã®çµ±è¨ˆæƒ…å ±ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚
  %div{style: "margin-top: 20px;", align: 'center' }
    %table{style: 'margin-top: 4px;'}
      %thead
        %tr
          %th
          %td{style: 'padding: 0 10px; font-weight: bold;'} æ²è¼‰ä¸­ã®é“å ´æ•°
          %td{style: 'padding: 0 10px; font-weight: bold;'} ç´¯è¨ˆé–‹å‚¬å›æ•°
          %td{style: 'padding: 0 10px; font-weight: bold;'} ç´¯è¨ˆå‚åŠ è€…æ•°
      %tbody{style: 'text-align: center;'}
        %tr
          %td
          %td= @sum_of_dojos
          %td= @sum_of_events
          %td= @sum_of_participants
  %div{style: "margin-top: 20px;", align: 'center'}
    %br
    = high_chart("dojo_tag_chart", @dojo_tag_chart)

  %h3#howto{style: "margin-top: 80px; margin-bottom: 30px;"} âœ… é›†è¨ˆæ–¹æ³•ã¨é›†è¨ˆå¯¾è±¡ã«ã¤ã„ã¦
  %ul{style: 'list-style: none; margin-left: -10px;'}
    %li å‚åŠ è€…æ•°ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯æ•°ã§ã¯ãªãå»¶ã¹æ•°ã§ã™ã€‚
    %li é›†è¨ˆå¯¾è±¡ã¯ API ãªã©ã§é›†è¨ˆå¯èƒ½ãªé“å ´ã§ã™ã€‚

  %div{style: 'margin-top: 10px;'}
    æ¯é€±æœˆæ›œæœ10æ™‚ã«é›†è¨ˆã‚’ã—ã¦ã„ã¾ã™ã€‚
    %br
    é›†è¨ˆå¯¾è±¡ã®é“å ´æ•°ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚
  %div{style: 'margin-top: 10px;'}
  %b= @aggregated_dojos
  %b / #{@sum_of_dojos} Dojos

  %div{align: 'center', id: 'transition-table', style: 'margin-top: 30px;'}
    %b é›†è¨ˆå¯¾è±¡ã¨ãªã£ã¦ã„ã‚‹é“å ´æ•°ã®æ¨ç§»
    %table{style: 'margin-top: 4px;'}
      %thead
        %tr
          %th
          - @annual_dojos_table.keys.each do |year|
            %th{style: 'padding: 3px 5px; font-weight: normal;'} #{year}å¹´
      %tbody{style: 'text-align: center;'}
        %tr
          %td é“å ´æ•°
          - @annual_dojos_table.each_value do |num|
            %td
              %b= num


  %h3#dojos{style: "margin-top: 80px;"} ğŸ—¾ éƒ½é“åºœçœŒåˆ¥ã®é“å ´æ•°
  .japan-map{style: "width: 100%;"}
    %p#text{style: "margin: 20px auto; font-size: 140%;"} åŒ—æµ·é“: 10
    #japan-map-container

  #accordion.panel-group{"aria-multiselectable" => "true", :role => "tablist"}
    - @regions_and_dojos.each_with_index do |(region, dojos), index|
      .panel.panel-default
        .panel-heading{:id => "heading#{index}", :role => "tab"}
          %h4.panel-title
            %a{"data-parent" => "#accordion", "data-toggle" => "collapse", :href => "##{"collapse#{index}"}", :role => "button"}
              %i.fa.fa-chevron-right{"aria-hidden" => "true"}
              = region
              \- #{dojos.count} Dojos
        .panel-collapse.collapse{:id => "collapse#{index}", :role => "tabpanel"}
          .panel-body.grayscale-bg.dojo-flex
            = render partial: 'shared/dojo', collection: dojos

  %h3#references{style: "margin-top: 60px;"} ğŸ“š é–¢é€£ãƒªãƒ³ã‚¯
  %ul{:style => "list-style: none; text-align: center; width: 100%; line-height: 1.7em; margin-bottom: 40px;"}
    %li
      %a{:href => "https://github.com/coderdojo-japan/coderdojo.jp/issues?utf8=%E2%9C%93&q=is%3Aclose+label%3A%E7%B5%B1%E8%A8%88%E6%83%85%E5%A0%B1+"} çµ±è¨ˆæƒ…å ±ã«é–¢ã™ã‚‹ã€ã“ã‚Œã¾ã§ã€ã®é–‹ç™º - GitHub
    %li
      %a{:href => "https://github.com/coderdojo-japan/coderdojo.jp/labels/%E7%B5%B1%E8%A8%88%E6%83%85%E5%A0%B1"} çµ±è¨ˆæƒ…å ±ã«é–¢ã™ã‚‹ã€ã“ã‚Œã‹ã‚‰ã€ã®é–‹ç™º - GitHub
    %li
      %a{:href => "https://docs.google.com/spreadsheets/d/17-M-qv5c0MdE_ZIFk566I2CGCIDHFkQwXWiunDXCGVw/edit#gid=354377216"} æ—¥æœ¬ã® CoderDojo (Zen & Japan) - Spreadsheet
%br/

:javascript
  $(function(){
    var ac = "dodgerblue"  // Area Color
    var hc = "deepskyblue" // Hover Color
    var areas = [
      {"code":1 ,  "name":"åŒ—æµ·é“åœ°æ–¹", "color":ac, "hoverColor":hc, "prefectures":[1]},
      {"code":2 ,  "name":"æ±åŒ—åœ°æ–¹",   "color":ac, "hoverColor":hc, "prefectures":[2,3,4,5,6,7]},
      {"code":3 ,  "name":"é–¢æ±åœ°æ–¹",   "color":ac, "hoverColor":hc, "prefectures":[8,9,10,11,12,13,14]},
      {"code":4 ,  "name":"åŒ—é™¸ãƒ»ç”²ä¿¡è¶Šåœ°æ–¹",   "color":ac, "hoverColor":hc, "prefectures":[15,16,17,18,19,20]},
      {"code":4 ,  "name":"æ±æµ·åœ°æ–¹",   "color":ac, "hoverColor":hc, "prefectures":[21,22,23,24]},
      {"code":6 ,  "name":"è¿‘ç•¿åœ°æ–¹",   "color":ac, "hoverColor":hc, "prefectures":[25,26,27,28,29,30]},
      {"code":7 ,  "name":"ä¸­å›½åœ°æ–¹",   "color":ac, "hoverColor":hc, "prefectures":[31,32,33,34,35]},
      {"code":8 ,  "name":"å››å›½åœ°æ–¹",   "color":ac, "hoverColor":hc, "prefectures":[36,37,38,39]},
      {"code":9 ,  "name":"ä¹å·åœ°æ–¹",   "color":ac, "hoverColor":hc, "prefectures":[40,41,42,43,44,45,46]},
      {"code":10 , "name":"æ²–ç¸„åœ°æ–¹",   "color":ac, "hoverColor":hc, "prefectures":[47]}
    ];

    $("#japan-map-container").japanMap(
      {
        areas: areas,
        selection: "prefecture",
        borderLineWidth: 0.1,
        drawsBoxLine:  false,
        movesIslands:  true,
        showsAreaName: false,
        showsPrefectureName: true,
        prefectureNameType: "short",
        width: 800,
        font : "MS Mincho",
        fontSize  : 9,
        fontColor : "white",
        fontShadowColor : "black",
        onSelect:function(data){
          alert(data.name);
        },
        onHover:function(data){
          $("#text").html(data.name + ": " + "#{@sum_of_dojos}");
        }
      }
    );
  });


